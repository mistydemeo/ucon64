dnl Process this file with autoconf to produce a configure script.
AC_INIT(ucon64.c)

dnl Checks for programs.
AC_PROG_CC
AC_PROG_INSTALL

CFLAGS="-I. -Wall -O3"
LDFLAGS=-s

dnl Checks for libraries.
AC_ARG_WITH(zlib,[  --with-zlib             build with zlib support],with_zlib=$withval)
AC_MSG_CHECKING(for zlib)
if test x$with_zlib = xyes; then
  with_zlib=no
  AC_TRY_COMPILE([
  #include <zlib.h>
  ],[
  ],[
  with_zlib=yes
  ])
  AC_MSG_RESULT($with_zlib)
  if test x$with_zlib = xyes; then
    LDFLAGS="$LDFLAGS -lz"
    DEFINE_ZLIB="#define ZLIB"
# We could also do CFLAGS="$CFLAGS -DZLIB" instead.
  fi
else
  AC_MSG_RESULT(not enabled by user)
fi

#AC_ARG_ENABLE(debug,[  --enable-debug          enable support for debugging output], [with_debug=yes])

dnl Checks for header files.
AC_HEADER_DIRENT
AC_HEADER_STDC
AC_CHECK_HEADERS(fcntl.h limits.h unistd.h)

dnl Checks for typedefs, structures, and compiler characteristics.
AC_C_CONST
AC_TYPE_UID_T
AC_C_INLINE
AC_TYPE_PID_T
AC_TYPE_SIZE_T

dnl Checks for library functions.
AC_PROG_GCC_TRADITIONAL
AC_FUNC_MEMCMP
AC_FUNC_STRFTIME
AC_FUNC_VPRINTF
AC_CHECK_FUNCS(getcwd mkdir putenv rmdir strcspn strerror strtol basename dirname)

AC_SUBST(DEFINE_ZLIB)
AC_OUTPUT(Makefile config.h)

echo
echo NOTE: On non-Linux systems you might need to use gmake instead of make
