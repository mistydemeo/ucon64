.PHONY: all clean install uninstall

GTK=1
#CURSES=1
#SDL=1

CC=@CC@

CFLAGS=-I. -I./html2gui/src/ -Wall -O3
LDFLAGS=-s

OBJECTS=ucon64gui.o misc.o url.o \
        console/snes.o top.o bottom.o console/swan.o console/gba.o \
        configmenu/configmenu.o console/nes.o console/n64.o console/gb.o \
        console/sms.o \
	html2gui/src/html2gui.o console/genesis.o console/dc.o console/lynx.o \
        console/jaguar.o console/pce.o console/neogeo.o console/ngp.o


ifdef GTK
  CFLAGS+=  `gtk-config --cflags`
  LDFLAGS+= `gtk-config --cflags --libs`
endif

ifdef SDL
  CFLAGS+=  `sdl-config --cflags`
  LDFLAGS+= `sdl-config --cflags --libs`
endif



all: ucon64gui

clean:
	rm -f $(OBJECTS) DEADJOE */DEADJOE ucon64gui *~ */*~ */*/*~ *.core

distclean: clean
	rm -f Makefile config.log config.status config.cache config.h

.c.o:
	$(CC) $(CFLAGS) -c $< -o $@

ucon64gui: $(OBJECTS)
	$(CC) -o $@ $(OBJECTS) $(LDFLAGS)
	cp ucon64gui ../bin

install:
#	./install.sh

uninstall:
	rm -f /usr/local/bin/ucon64gui

# Dependencies
UCON64GUI_STD_H=ucon64_defines.h misc.h config.h ucon64gui.h

misc.o: misc.h
ucon64_gui.o: switches.c options.c $(UCON64GUI_STD_H)
html2gui/src/html2gui.o: html2gui/src/html2gui.h html2gui/src/gtk/gtk.c html2gui/src/sdl/sdl.c html2gui/src/curses/curses.c $(UCON64GUI_STD_H)
configmenu/configmenu.o: configmenu/configmenu.h $(UCON64GUI_STD_H)
console/gb.o: console/gb.h $(UCON64GUI_STD_H)
console/n64.o: console/n64.h $(UCON64GUI_STD_H)
console/nes.o: console/nes.h $(UCON64GUI_STD_H)
console/snes.o: console/snes.h $(UCON64GUI_STD_H)
